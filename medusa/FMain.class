' Gambas class file


PUBLIC SUB Form_Open()

  TabStrip1.Picture = Picture["icon:/16/text"]
  TextArea1.SetFocus
  TextArea1_Cursor
  Expander1.Hidden = TRUE
  TextArea1 = TabStrip1.Children[0]
  
END

PUBLIC SUB TextArea1_Cursor()
  
SpinBox1.Value = TextArea1.Font.Size
  
END

PUBLIC SUB SpinBox1_Change()

  TextArea1.Font.Size = LAST.Value
  TextArea1.SetFocus

END

PUBLIC SUB form_Close()
  
IF Message.Warning("Â¿Seguro que desea cerrar?" & "\n" & "Todo cambio no guardado se perdera",
"Cerrar", "Cancelar") = 1 THEN
ME.Close
ENDIF  
  
END


PUBLIC SUB nuevo_Click()

DIM txtTemp AS TextArea

nuevaHoja()


END

PUBLIC SUB close_Click()

close.Enabled = TRUE
TextArea1 = TabStrip1.Children[0]

IF TabStrip1.Count > 1 THEN 

close.Enabled = FALSE

ELSE 

ME.close

ENDIF

END

PUBLIC SUB guardar_Click()

DIM destino AS String ' cadena donde se guarda la ruta y nombre del archivo

TextArea1 = TabStrip1.Children[0]

Dialog.Title = "Escriba un nombre de archivo para guardar los datos"
 dialog.Filter = ["*", "Todos Los Archivos", "*.txt", "Texto"]

IF NOT Dialog.SaveFile() THEN
IF Right$(Dialog.Path, 5) <> ".txt" THEN
destino = Dialog.Path & ".txt"
ELSE
destino = Dialog.Path
END IF
FMain.title = "Archivo: " & Dialog.Path

File.Save(destino, TextArea1.text)

END IF

END

PUBLIC SUB nuevaHoja()

DIM TextArea1 AS TextArea

TabStrip1.Count += 1

TabStrip1.Text = "Documento " & Str(TabStrip1.Index + 1) & " no guardado"

TextArea1 = NEW TextArea(TabStrip1) AS "editores"

TabStrip1.Children[0].Name = "TextArea1" & CStr(TabStrip1.Index + 1)

TextArea1.expand = TRUE

END

PUBLIC SUB abrir_Click()

DIM arrCad AS NEW String[]
DIM txtTemp AS TextArea
DIM c AS String
DIM ruta AS String

txtTemp = TabStrip1.Children[0]

Dialog.Title = "Seleccione un archivo"

Dialog.Filter = ["*", "Todos Los Archivos", "*.txt", "Texto", " *.sh", " ShellScript ", "*.html", " HTML "]

IF NOT Dialog.OpenFile() THEN

ruta = Dialog.Path

arrCad = Split(File.Load(ruta), "\n")


END IF

IF txtTemp.Text <> "" THEN
nuevaHoja()
END IF

FOR EACH c IN arrCad

TabStrip1.Text = ruta

txtTemp = TabStrip1.Children[0]

txtTemp.Text &= c & "\n"

NEXT

END

PUBLIC SUB borrar_Click()

TextArea1 = TabStrip1.Children[0]
TextArea1.Clear

END

PUBLIC SUB copiar_Click()

TextArea1 = TabStrip1.Children[0]
TextArea1.Copy

END

PUBLIC SUB pegar_Click()

TextArea1 = TabStrip1.Children[0]
TextArea1.Paste

END

PUBLIC SUB salir_Click()

ME.close

END

PUBLIC SUB abrir2_Click()

DIM arrCad AS NEW String[]
DIM txtTemp AS TextArea
DIM c AS String
DIM ruta AS String

txtTemp = TabStrip1.Children[0]

Dialog.Title = "Seleccione un archivo"

Dialog.Filter = ["*", "Todos Los Archivos", "*.txt", "Texto", " *.sh", " ShellScript ", "*.html", " HTML "]

IF NOT Dialog.OpenFile() THEN

ruta = Dialog.Path

arrCad = Split(File.Load(ruta), "\n")


END IF

IF txtTemp.Text <> "" THEN
nuevaHoja()
END IF

FOR EACH c IN arrCad

TabStrip1.Text = ruta

txtTemp = TabStrip1.Children[0]

txtTemp.Text &= c & "\n"

NEXT


END

PUBLIC SUB guadarcomo_Click()

DIM destino AS String ' cadena donde se guarda la ruta y nombre del archivo

TextArea1 = TabStrip1.Children[0]

Dialog.Title = "Escriba un nombre de archivo para guardar los datos"
 dialog.Filter = ["*", "Todos Los Archivos", "*.txt", "Texto", " *.sh", " ShellScript ", "*.html", " HTML "]

IF NOT Dialog.SaveFile() THEN
IF Right$(Dialog.Path, 5) <> ".txt" THEN
destino = Dialog.Path & ".txt"
ELSE
destino = Dialog.Path
END IF

FMain.title = "Archivo: " & Dialog.Path

File.Save(destino, TextArea1.text)


END IF

END


PUBLIC SUB copia2_Click()

TextArea1 = TabStrip1.Children[0]
TextArea1.copy

END

PUBLIC SUB cortar_Click()

TextArea1 = TabStrip1.Children[0]
TextArea1.Cut

END

PUBLIC SUB pegar2_Click()

TextArea1 = TabStrip1.Children[0]
TextArea1.paste

END

PUBLIC SUB cortar2_Click()

TextArea1 = TabStrip1.Children[0]
TextArea1.cut

END



PUBLIC SUB seleccionar_Click()

TextArea1 = TabStrip1.Children[0]
TextArea1.SelectAll

END

PUBLIC SUB licencia_Click()

Form1.show

END

PUBLIC SUB rehacer_Click()

TextArea1.redo

END

PUBLIC SUB deshacer_Click()

TextArea1.undo

END

PUBLIC SUB deshacer2_Click()

TextArea1 = TabStrip1.Children[0]
TextArea1.undo

END

PUBLIC SUB rehacer2_Click()

TextArea1 = TabStrip1.Children[0]
TextArea1.redo

END

PUBLIC SUB aumentar_Click()

TextArea1 = TabStrip1.Children[0]
SpinBox1.value += 1

END

PUBLIC SUB disminuir_Click()

TextArea1 = TabStrip1.Children[0]
SpinBox1.Value -= 1

END

PUBLIC SUB Buscar_Click()

  DIM IndexRecherche AS Integer
  IndexRecherche = InStr(TextArea1.Text, busqueda.Text, gb.Text)
  TextArea1.Select(IndexRecherche - 1, Len(busqueda.Text))

END

PUBLIC SUB Menu3_Click()

ME.close

END

PUBLIC SUB about_Click()

Form2.show

END

PUBLIC SUB nuevo2_Click()

TextArea1 = TabStrip1.Children[0]
nuevaHoja()


END

PUBLIC SUB botonir_Click()

DIM numero AS String

numero = lineabox.text
TextArea1 = TabStrip1.Children[0]
TextArea1.line = numero

END

PUBLIC SUB siguientelinea_Click()

DIM numero AS Integer


numero = lineabox.text
lineabox.text = lineabox.text + 1
TextArea1 = TabStrip1.Children[0]
TextArea1.Line = numero + 1

END

PUBLIC SUB Menu6_Click()



END
